(()=>{(function(){if(window.__SBF_WIDGET_ACTIVE__)return;window.__SBF_WIDGET_ACTIVE__=!0;let m=(window.__CHATBOT_NAME__||"Chat")+"",a=Object.assign({accent:"#2dd4bf",accent2:"#22c55e",text:"#0f172a",subtle:"#64748b",bg:"rgba(255,255,255,0.86)",bg2:"rgba(250,250,251,0.86)",border:"rgba(0,0,0,.08)",radius:18,width:340,heightVH:70},window.__CHATBOT_THEME__||{}),y=window.__CHATBOT_AVATAR__||null,E=2147483647;(function(){if(document.getElementById("sbf-widget-styles"))return;let n=`
      :root{
        --sbf-bg: ${a.bg};
        --sbf-bg-2: ${a.bg2};
        --sbf-border: ${a.border};
        --sbf-shadow: 0 24px 60px rgba(0,0,0,.30);
        --sbf-accent: ${a.accent};
        --sbf-accent-2: ${a.accent2};
        --sbf-text: ${a.text};
        --sbf-subtle: ${a.subtle};
        --sbf-radius: ${a.radius}px;
      }
      @media (prefers-color-scheme: dark){
        :root{
          --sbf-shadow: 0 24px 60px rgba(0,0,0,.60);
        }
      }
      #sbf-panel{
        position:fixed; right:20px; bottom:92px;
        width:${a.width}px; max-width:92vw; height:${a.heightVH}vh; max-height:720px;
        display:none; z-index:${E};
        background: var(--sbf-bg); backdrop-filter: blur(10px);
        border: 1px solid var(--sbf-border);
        border-radius: var(--sbf-radius); box-shadow: var(--sbf-shadow);
        overflow:hidden; contain: content;
      }
      #sbf-panel[data-open="true"]{ display:flex; flex-direction:column; }

      .sbf-header{
        display:flex; align-items:center; gap:.75rem;
        padding:.75rem .9rem; background: var(--sbf-bg-2);
        border-bottom:1px solid var(--sbf-border);
      }
      .sbf-title{ margin:0; font:600 14px/1.2 ui-sans-serif,system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial; color:var(--sbf-text); }
      .sbf-sub{ font:500 12px/1 ui-sans-serif,system-ui; color:var(--sbf-subtle); }
      .sbf-avatar{
        height:28px;width:28px;border-radius:9999px; flex:none; overflow:hidden;
        background: radial-gradient(circle at 30% 20%, var(--sbf-accent), var(--sbf-accent-2));
        display:grid;place-items:center;color:#001012;font-weight:800;
      }
      .sbf-header .sbf-x{
        margin-left:auto; border:1px solid var(--sbf-border); background:transparent;
        padding:.35rem .55rem; border-radius:10px; cursor:pointer; color:var(--sbf-text);
      }

      .sbf-messages{
        flex:1; min-height:0; overflow:auto; padding:12px; background:transparent;
        scroll-behavior:smooth;
      }
      .sbf-row{ display:flex; margin:6px 0; }
      .sbf-row.bot{ justify-content:flex-start; }
      .sbf-row.user{ justify-content:flex-end; }
      .sbf-bubble{
        max-width:82%; padding:.55rem .75rem; border-radius:14px; border:1px solid var(--sbf-border);
        font: 14px/1.35 ui-sans-serif,system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial; color:var(--sbf-text);
        word-wrap:break-word; white-space:pre-wrap; background:rgba(255,255,255,.65);
      }
      .sbf-row.bot .sbf-bubble{ background:rgba(99,102,241,.08); }
      .sbf-row.user .sbf-bubble{ background:rgba(148,163,184,.12); }

      .sbf-input{
        display:flex; align-items:flex-end; gap:.5rem;
        padding:.65rem .65rem; background: var(--sbf-bg-2);
        border-top:1px solid var(--sbf-border);
      }
      .sbf-textarea{
        flex:1; min-height:38px; max-height:120px; resize:none;
        padding:.6rem .75rem; border:1px solid var(--sbf-border); border-radius:12px; outline:none;
        background: rgba(255,255,255,.85); color:var(--sbf-text);
        font: 14px/1.3 ui-sans-serif,system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial;
      }
      .sbf-textarea:focus{
        box-shadow: 0 0 0 3px rgba(99,102,241,.25);
        background: rgba(255,255,255,.95);
      }
      .sbf-send{
        display:inline-flex; align-items:center; justify-content:center; gap:.35rem;
        padding:.55rem .75rem; border:1px solid var(--sbf-border); border-radius:12px;
        background:#fff; cursor:pointer; color:#111827; font:600 13px/1 ui-sans-serif,system-ui;
      }
      .sbf-send svg{ display:block }
      .sbf-send:disabled { opacity:.5; cursor:not-allowed; }

      #sbf-bubble{
        position:fixed; right:20px; bottom:20px; z-index:${E};
        height:56px;width:56px;border-radius:9999px;border:1px solid var(--sbf-border);
        background: radial-gradient(120% 120% at 20% 20%, var(--sbf-accent), var(--sbf-accent-2));
        color:#001012; cursor:pointer; box-shadow: var(--sbf-shadow);
        display:grid; place-items:center; font-size:22px;
      }

      @media (max-width:480px){
        #sbf-panel{ right:12px; bottom:86px; width:calc(100vw - 24px); height:64vh; }
        #sbf-bubble{ right:12px; bottom:12px; }
      }
    `.trim(),o=Object.assign(document.createElement("style"),{id:"sbf-widget-styles",textContent:n});document.head.appendChild(o)})();function T(){let e=document.getElementById("sbf-bubble");return e||(e=document.createElement("button"),e.id="sbf-bubble",e.type="button",e.setAttribute("aria-label","Open chat"),e.textContent="\u{1F4AC}",document.body.appendChild(e)),e.__bound||(e.addEventListener("click",()=>g("toggle")),e.__bound=!0),e}function C(){var A;let e=document.getElementById("sbf-panel");if(e)return e;e=document.createElement("div"),e.id="sbf-panel",e.setAttribute("aria-hidden","true");let n=document.createElement("div");n.className="sbf-header";let o=document.createElement("div");if(o.className="sbf-avatar",y){let t=new Image;t.src=y,t.alt="",t.style.width="100%",t.style.height="100%",t.style.objectFit="cover",o.appendChild(t)}else o.textContent=((A=m==null?void 0:m[0])==null?void 0:A.toUpperCase())||"A";let b=document.createElement("div"),p=document.createElement("div");p.className="sbf-title",p.textContent=m;let h=document.createElement("div");h.className="sbf-sub",h.textContent="Online",b.appendChild(p),b.appendChild(h);let f=document.createElement("button");f.className="sbf-x",f.type="button",f.setAttribute("aria-label","Close chat"),f.textContent="\xD7",f.addEventListener("click",()=>g("close")),n.appendChild(o),n.appendChild(b),n.appendChild(f);let i=document.createElement("div");i.className="sbf-messages",i.id="chat-messages";let u=document.createElement("div");u.className="sbf-input";let s=document.createElement("textarea");s.className="sbf-textarea",s.id="chat-input",s.placeholder="Type a message\u2026",s.rows=1,s.autocomplete="off",s.spellcheck=!0,s.readOnly=!1,s.disabled=!1,s.style.pointerEvents="auto",u.style.pointerEvents="auto";let r=document.createElement("button");r.className="sbf-send",r.type="button",r.id="chat-send",r.setAttribute("aria-label","Send message"),r.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 12l18-9-9 18-2-7-7-2z"></path></svg><span>Send</span>';function x(){s.style.height="auto",s.style.height=Math.min(s.scrollHeight,120)+"px"}s.addEventListener("input",x),setTimeout(x,0),s.addEventListener("keydown",t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),k())});let w=!1;async function k(){var l;let t=(s.value||"").trim();if(!(!t||w)){w=!0,r.disabled=!0,v(t,"user");try{if(window.dispatchEvent(new CustomEvent("chat:send",{detail:{text:t}})),typeof window.sendMessage=="function")await Promise.resolve(window.sendMessage(t));else if((l=window.EnterpriseChatbotWidgetAPI)!=null&&l.send)await Promise.resolve(window.EnterpriseChatbotWidgetAPI.send(t));else try{let d=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t})});if(d.ok){let c=await d.json(),I=c&&(c.reply||c.response)||"\u2713 Message sent.";v(I,"bot")}}catch{}}catch(d){console.error("send failed",d)}finally{s.value="",x(),s.focus(),w=!1,r.disabled=!1,i.scrollTop=i.scrollHeight}}}r.addEventListener("click",k),u.appendChild(s),u.appendChild(r),e.appendChild(n),e.appendChild(i),e.appendChild(u),document.body.appendChild(e);function v(t,l){let d=document.createElement("div");d.className="sbf-row "+(l==="user"?"user":"bot");let c=document.createElement("div");c.className="sbf-bubble",c.textContent=t,d.appendChild(c),i.appendChild(d),i.scrollTop=i.scrollHeight}return window.addEventListener("chat:reply",t=>{let l=t.detail&&t.detail.text||"";l&&v(l,"bot")}),e}function g(e){let n=C(),o=n.getAttribute("data-open")==="true",b=e==="open"?!0:e==="close"?!1:!o;if(n.setAttribute("data-open",String(b)),n.setAttribute("aria-hidden",String(!b)),b){let p=n.querySelector("#chat-input");p&&requestAnimationFrame(()=>p.focus())}}window.toggleChat=g,document.querySelectorAll('[onclick*="toggleChat"]').forEach(e=>e.removeAttribute("onclick"));function _(){T(),C()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",_):_(),document.addEventListener("keydown",e=>{e.key==="Escape"&&g("close")})})();})();
//# sourceMappingURL=widget.min.js.map
